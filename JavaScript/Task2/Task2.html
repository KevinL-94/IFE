<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IFE JavaScript Task2</title>
</head>
<body>

  <h3>城市污染列表</h3>
  <label>设置AQI报警值：
        <input id="aqi-input" type="text" value="60" />
        <button id="button">确定</button>
  </label>
  <ul id="aqi-list">
    <li></li>
  </ul>
  
<script type="text/javascript">

  var aqiData = [
    ["北京", 90],
    ["上海", 50],
    ["福州", 10],
    ["广州", 50],
    ["成都", 90],
    ["西安", 100]
  ];

  (function(){
    /*
    在注释下方编写代码
    遍历读取aqiData中各个城市的数据
    将空气质量指数大于60的城市显示到aqi-list的列表中
    */
    var chineseNumbers = ["一", "二", "三", "四", "五", "六", "七", "八", "九"];
    var input = document.getElementById("aqi-input");
    var btn = document.getElementById("button");

    function handler() {
      var result = "";
      var aqi = parseInt(input.value);
      if ((!isNaN(aqi)) && (aqi >= 0) && (aqi <= 100)) {
        aqiData.filter(function(element) {return element[1] >= input.value;}) 
               .sort(function(value1, value2) {return value2[1] - value1[1];})
               .forEach(function(element, index) {
                result += "<li>第" + chineseNumbers[index] +"名：" + element[0] + "，" +element[1] + "</li> \n";
               });
        document.getElementById("aqi-list").innerHTML = result;
      } else {
        alert(input.value + "不是有效的AQI值，请输入0~100中的整数！");
      }
    }

    handler();

    btn.onclick = function() {
      handler();
    };

    input.onkeyup = function(event) {
      if (event.keyCode === 13) {
        handler();
      }
    };
    
  })();
</script>
</body>
</html>